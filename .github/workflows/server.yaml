name: ENC-RUNNER
'on':
  push:
    branches:
      - server
jobs:
  download:
    runs-on: ubuntu-latest
    container:
      image: docker.io/amandaa00/git-atc:latest
    steps:
      - name: Cache files
        id: cache-files
        uses: actions/cache@v3
        with:
          path: /app
          key: ${{ github.sha }}
      - name: Run script
        run: >-
          cd /app

          python3 download.py
          ZnVjawZXlKUFYwNUZVaUk2SWtwcGJuaHpZVzRpTENKU1JWQlBJam9pYkdsMFpYSmhkR1V0Wlc1cFoyMWhJaXdpVkVkZlFWQkpYMGxFSWpvaU1UWTFORFl5TnpBaUxDSlVSMTlCVUVsZlNFRlRTQ0k2SWpGbE1XVm1NV0ppWWpabE9HTTJZbU01TURBeU1EZGpZVFZoTVRGalpqWmlJaXdpVkVkZlFrOVVYMVJQUzBWT0lqb2lOVEk0TWprM05EYzJOVHBCUVVkSVRtcENRM0ZTZVhaNFoxVlRPVzk1TkVoVVIwTjBOVUpEYW5Oa0xVcGljeUlzSWtaSlRFVWlPakV6TmpZc0lrWkpURVZmVGtGTlJTSTZJbHNnUWt4RElGMGdJRk14UlRnZ1UyaHZaM1Z1TG0xcmRpSXNJa2xFSWpvaVUyaHZYMlZtTWpnMVBUY2lMQ0pEVFVRaU9pSmFiVnAwWTBkV2JrbERNWEJKU0hSd1ltdzViV0ZYZUd4bVUwRjBXWHB3TWtsSGVIQlpibWQ1VG1wVloweFlaM2xPYWxWMFkwZEdlVmxYTVhwSlJ6VjJURmRzZFZwdE9EbE5VMEYwWkcxWlowbHRVbmxaV0dRd1dsaG9NRkJYV25aaWJsSnRZVmQ0YkZCWFozVmtTRkp0VDIxYWRtSnVVbXBpTW5oMlkyb3hNMkZIYkRCYVZIQnBZak5LYTFwWVNtcGlNbmgyWTJveGFXSkhSbXBoTUVGM1RHcFZkMDl1WnpsTmFrRTJaVlF3ZVUxRWNHbGlNMmM1VFZSd2FXSXphR3BpTW5oMlkyb3hhV0pIUm1waE1FRjNUR3BWTmxsdE9UUlpiVGw1V2tkV2VXUjZNREpQYmxKc1pVaFJPVW94VW14aVIxWnVZMjFHZEVsRE1HZFhNRUpwWWtoV2JGa3lSbkphVmpsMVdsaFNNMkl6U25KWVUwRnVUMjFXZFZsWFNuTmFWREJ1V1cxV01HUXlWbXhpYVdnd1RFUkJjMDVVUVhkTFUyTTJXVmQ0ZDJGSFJUbEtNbXh0UzBkNE1FdElVWE5PUkdzMVMxWjNjMDFXZDNOaFYxbHZZa2hSYjJSR2QzTk9WRUYzUzFaM2MwdEVSWFJMU0ZGMFRrUnJOVXRUYTNaTlZuZHpUVU5yY0VwNVNXZE1WekZvWTBOQmQwbERNWFJhV0ZKb1drZEdNRmxVY0hwUGJVVTJUVU5DTUdGWVVuTmFWREJwVnpCQ2FXSklWbXhaTWtaeVdsWTVkVnBZVWpOaU0wcHlXRk5KWjB4WE1XeGtSMFpyV1ZoU2FFOXVUVFpqZW05M1NVaFNjR1JIZUd4UVUwcGlVVWRLYzJSWFZtcFpWM1JzV0RJMWJHUklaSFpqYlhSa1NXbEJkR0pYVmpCWlYxSm9aRWRGWjJSSGJEQmlSMVU1U1d4MFFWbHRlREZhVjA1b1lUSldabUp0VmpCa01qbDVZVEV3WjBscFFYUlpNMHB0U1VSSk0wbERNWGRoV0dobVdtMHhNRWxJYkRGa2FsRjVUVWhCWjB4WVNXZE5hazExVDFSak1rbERNWHBKUkdkNVRVaG5NRTlFUVdkTVYzaDJXako0YkdSdFZuTkpSMVo1WTIwNWVVbERNWGRqYlZaNldsaFJaMk15ZUhaa2VVRjBXWHB3YUVsSGVIQlpiVGwzWkZoTloweFhSbXBKUkVsblRGZEpObGxUUVRGTlIzTm5URmROTm1ONVFtcGlNMEkxU1VoMGRtTkdPVzFoVjNoc1psTkJkR1ZSUFQwaWZRPT0=
  encode:
    runs-on: ubuntu-latest
    needs: download
    container:
      image: docker.io/amandaa00/git-atc:latest
    steps:
      - name: Cache files
        id: cache-files
        uses: actions/cache@v3
        with:
          path: /app
          key: ${{ github.sha }}
      - name: Run script
        run: |
          cd /app
          python3 encode.py
      - name: Cache files after encode
        id: cache-files-encode
        uses: actions/cache@v3
        with:
          path: /app
          key: ${{ github.sha }}-1
  upload:
    runs-on: ubuntu-latest
    needs: encode
    container:
      image: docker.io/amandaa00/git-atc:latest
    steps:
      - name: Cache files
        id: cache-files
        uses: actions/cache@v3
        with:
          path: /app
          key: ${{ github.sha }}-1
      - name: Run script
        run: |
          cd /app
          python3 upload.py
